<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <title>饭饭之交</title>
  <link rel="icon" type="image/png" href="picture/home/饭饭之交.png">
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" th:href="@{/layui/css/layui.css}"/>
  <link rel="stylesheet" th:href="@{/css/homepage.css}"/>
</head>

<body>
<div class="layui-layout layui-layout-admin">
      <!-- 背景颜色开始 -->
  <style>
    body {
      background-color:   rgba(193, 131, 38, 0.152);
    }
  </style>
       <!-- 背景颜色结束 -->

  <div class="layui-header  layui-bg-gray">

      <!-- 头部搜素框开始 -->
      <!-- 搜索框容器 -->
      <div class="search-container">
          <!-- 搜索输入框 -->
          <input type="text" id="searchInput" class="search-input" placeholder="输入进行搜索">
          <!-- 搜索按钮 -->
          <button id="searchButton" class="search-button">搜索</button>
      </div>

      <!-- 相关内容显示区域 -->
      <ul class="suggestions" id="suggestionsContainer"></ul>
      <!-- 头部搜索框结束 -->

    <div class="layui-logo layui-bg-gray">
      <img src="picture/home/饭饭之交.png" class="layui-nav-img">
      饭饭之交
  </div>
    
    <ul class="layui-nav layui-layout-left layui-bg-gray">
      <!-- 移动端显示 -->
      <li class="layui-nav-item layui-show-xs-inline-block layui-hide-sm" lay-header-event="menuLeft">
        <i class="layui-icon layui-icon-spread-left"></i>
      </li>
    </ul> 
      


    <ul class="layui-nav layui-layout-right layui-bg-gray">
      <li class="layui-nav-item layui-hide-xs">
        <a th:href="postThread">
          <img src="picture/home/投稿.png"class="layui-nav-img" style="width: 25px;height: 25px;">发帖
        </a>
      </li>
      <li class="layui-nav-item layui-hide layui-show-sm-inline-block ">
        <a href="javascript:;">
            <img th:src="@{'/picture/' + ${session.user.userAvatar}}" class="layui-nav-img">
            [[${session.user.NickName}]]
        </a>    
        <dl class="layui-nav-child">
          <dd><a th:href="@{/userModify(userId=${session.user.userId})}"><img src="picture/home/个人中心.png"class="layui-nav-img" style="width: 25px;height: 25px;">个人中心</a></dd>
<!--          <dd><a href="javascript:;"><img src="picture/home/消息.png"class="layui-nav-img" style="width: 25px;height: 25px;">消息</a></dd>-->
            <dd><a th:href="@{/friend}"><img src="picture/home/好友.png"class="layui-nav-img" style="width: 25px;height: 25px;">好友</a></dd>
<!--        <li class="layui-nav-item"><a th:href="@{/friend}"><img src="picture/home/好友.png" class="layui-nav-img">好友</a></li>-->
<!--          <dd><a th:href="@{/userModify(userId=${session.user.userId})}"><img src="picture/home/消息.png"class="layui-nav-img" style="width: 23px;height: 23px;">修改信息</a></dd>-->
          <dd><a th:href="@{/logout}"><img src="picture/home/退出.png" class="layui-nav-img" style="width: 25px;height: 25px;">注销</a></dd>
        </dl>
      </li>
    </ul>
  </div>

  <div class="layui-side layui-bg-gray">
    <div class="layui-side-scroll layui-bg-gray">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree layui-bg-gray" lay-filter="test">
        <li class="layui-nav-item layui-nav-itemed">
          <a class="" href="javascript:;"><img src="picture/home/热点内容.png" class="layui-nav-img">热点内容</a>
          <dl class="layui-nav-child">
            <dd><a href="javascript:;"><img src="picture/home/推荐.png" class="layui-nav-img" style="width: 20px;height: 20px;">推荐</a></dd>
            <dd><a href="javascript:;"><img src="picture/home/热门.png" class="layui-nav-img" style="width: 20px;height: 20px;">热门</a></dd>
            <dd><a href="javascript:;"><img src="picture/home/附近.png" class="layui-nav-img" style="width: 20px;height: 20px;">附近</a></dd>
          </dl>
        </li>
<!--        <li class="layui-nav-item"><a th:href="@{/friend}"><img src="picture/home/好友.png" class="layui-nav-img">好友</a></li>-->
        <li class="layui-nav-item ">
          <a href="javascript:;"><img src="picture/home/活动.png" class="layui-nav-img">活动</a>
          <dl class="layui-nav-child">
            <dd><a href="javascript:;"><img src="picture/home/个人征召.png" class="layui-nav-img" style="width: 20px;height: 20px;">个人征召</a></dd>
            <dd><a href="javascript:;"><img src="picture/home/团建.png" class="layui-nav-img" style="width: 20px;height: 20px;">团建</a></dd>
            <dd><a href="javascript:;"><img src="picture/home/官方活动.png" class="layui-nav-img" style="width: 20px;height: 20px;">官方活动</a></dd>
          </dl>
        </li>
        <li class="layui-nav-item">
          <a href="javascript:;"><img src="picture/home/更多.png" class="layui-nav-img">更多</a>
          <dl class="layui-nav-child">
            <dd><a href="javascript:;">待添加1</a></dd>
            <dd><a href="javascript:;">待添加2</a></dd>
            <dd><a href="javascript:;">待添加2</a></dd>
          </dl>
        </li>
        
      </ul>
    </div>
  </div>
  
  <div class="layui-body">
      <div style="padding: 5% ; width: 70%;">
        <div class="flow-demo" id="ID-flow-demo"></div>

        <!--  右侧开始   -->
        <div class="homepage-container">
            <ul>
                <li><a href="hot1.html">
                    <img src="picture/home/关于我们.png" class="layui-nav-img" style="width: 25px;height: 25px;">
                    关于我们</a></li>                      <!--  替换为实际的目标页面的 URL  -->
                <li><a href="hot2.html">
                    <img src="picture/home/联系我们.png" class="layui-nav-img" style="width: 20px;height: 20px;">
                    联系我们</a></li>                      <!--  替换为实际的目标页面的 URL  -->
                <li><a href="hot3.html">
                    <img src="picture/home/意见反馈.png" class="layui-nav-img" style="width: 20px;height: 20px;">
                    意见反馈</a></li>                      <!--  替换为实际的目标页面的 URL  -->
            </ul>
        </div>
    </div>
    <br><br>
  </div>
<!--  <div class="layui-footer">-->
<!--    &lt;!&ndash; 底部固定区域 &ndash;&gt;-->
<!--    底部固定区域-->
<!--  </div>-->
</div>
<script src="layui/layui.js"></script>
<script>
var contextPath = [[@{/}]];

layui.use(function(){
var flow = layui.flow,
    $ = layui.$;
// 流加载实例
flow.load({
  elem: '#ID-flow-demo', // 流加载容器
  scrollElem: '#ID-flow-demo', // 滚动条所在元素，一般不用填，此处只是演示需要。
  done: function(page, next){ // 执行下一页的回调
    // 发送 AJAX 请求从服务器获取新的帖子数据
    $.ajax({
      url: "[[@{/loadThreads}]]", // 替换为实际的从服务器获取数据的端点
      type: 'GET',
      data: { page: page },
      dataType: 'json',
      success: function(response){
        var lis = [];
        var threadList = response.thread,
            totalPage = response.totalPage;
        layui.each(threadList, function(index, thread){
          // 根据需要拼接帖子内容的HTML代码
          var html = `
            <div class="layui-card layui-panel">
              <div class="layui-card-header">
                <a href="javascript:;" layui-layout-right>
                  <img src="` + contextPath + `picture/${thread.userAvatar}" class="layui-nav-img"/>
                  ${thread.userNickName}
                </a>
              </div>
              <div class="layui-card-body">
                <a href="` + contextPath + `content?threadId=${thread.threadId}" layui-layout-right>
                  <p class="homepage-title">${thread.threadTitle}</p>
                  <br>
                  <p class="ellipsis">${thread.threadContent}</p>
                  <br>
                  <div class="image-container">
                    ${thread.imageUrl != null ? thread.imageUrl.map(function(imageUrl) {
                      return `<img src="` + contextPath + `picture/${imageUrl}"/>`;
                    }).join('') : ''}
                  </div>
                </a>
                <br>
                <div class="homepage-like-container">
                  <button id="likeButton" class="homepage-like-button" onclick="toggleLike()">点赞</button>
                  <p class="like-count">点赞数：<span id="likeCount">${thread.threadLike}</span></p>
                </div>
              </div>
            </div>
          `;
          lis.push(html);
        });

        // 执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
        next(lis.join(''), page < totalPage); // 假设总页数为 response.totalPage
      },
      error: function(error){
        console.log(error);
      }
    });
  }
});
});
</script>
</body>
</html>
